document.getElementById("loginForm")?.addEventListener("submit", async (e) => {
  e.preventDefault();
  const username = document.getElementById("username").value.trim();
  const password = document.getElementById("password").value.trim();
  const msg = document.getElementById("loginMsg");
  msg.textContent = "";

  try {
    if (!username || !password) {
      throw new Error("Please enter username and password.");
    }
    const user = await API.post("/api/auth/login", { username, password });
    localStorage.setItem("isLoggedIn", "true");
    localStorage.setItem("currentUser", username);
    localStorage.setItem("ptp_user", JSON.stringify(user));
    window.location.href = "dashboard.html";
  } catch (error) {
    console.error(error);
    msg.textContent = error.message || "Invalid username or password.";
  }
});
